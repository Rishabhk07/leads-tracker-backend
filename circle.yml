machine:
  node:
    version: 8.1.4
dependencies:
  override:
    - npm install --dev
test:
  pre:
    - export DATABASE_URL="postgres://ubuntu@localhost:5432/circle_test"
    - npm install -g typescript nyc mocha
  override:
    - tsc
    - nyc mocha
    - cp -r coverage/* $CIRCLE_TEST_REPORTS
  post:
    - bash <(curl -s https://codecov.io/bash)